<?xml version="1.0" encoding="utf-8" ?>
<XmlParserConfigurationRoot LCID="hu-HU">
  <XmlParser>
	<XmlVar Name="REDISSERVERIP">192.168.77.150</XmlVar>
    <XmlVar Name="REDISSERVERPORT">6379</XmlVar>
	<XmlVar Name="REELCHECKDBCONNECTIONSTRING">data source=REELCHECK;initial catalog=REELCHECK;user id=sa;password=vrh;MultipleActiveResultSets=True;App=EntityFramework;</XmlVar>
	<XmlVar Name="ALMDBCONNECTIONSTRING">data source=192.168.77.150\SQLEXPRESS;initial catalog=LearALM;user id=sa;password=Vrh@54321;MultipleActiveResultSets=True;App=EntityFramework;</XmlVar>
	<!--<XmlVar Name="LCID">en-US</XmlVar>-->
  </XmlParser>
  <Configurations>
    <Configuration Name="DataToRedisConfig0" Element="DataToRedisConfig0" />
  </Configurations>

  <DataToRedisConfig0>
    <General>
      <Frequency>2</Frequency>
    </General>
	<Pools>
		<Pool Id="ALM" Name="ALM" Version="2.5.2" SQLconnectionString="@ALMDBCONNECTIONSTRING@" RedisConnectionString="@REDISSERVERIP@" Initialize="false" CreateInstance="true" CreateVariable="true"/>
		<Pool Id="ANDON_SAE" Name="ANDON_SAE" Version="1.0.0" SQLconnectionString="@ALMDBCONNECTIONSTRING@" RedisConnectionString="@REDISSERVERIP@" Initialize="true" CreateInstance="true" CreateVariable="true"/>
		<Pool Id="ANDON_SAECODE" Name="ANDON_SAECODE" Version="1.0.0" SQLconnectionString="@ALMDBCONNECTIONSTRING@" RedisConnectionString="@REDISSERVERIP@" Initialize="true" CreateInstance="true" CreateVariable="true"/>
		<Pool Id="ANDON_ASSL" Name="ANDON_ASSL" Version="1.0.0" SQLconnectionString="@ALMDBCONNECTIONSTRING@" RedisConnectionString="@REDISSERVERIP@" Initialize="true" CreateInstance="true" CreateVariable="true"/>
		<Pool Id="ANDON_ASSLCODE" Name="ANDON_ASSLCODE" Version="1.0.0" SQLconnectionString="@ALMDBCONNECTIONSTRING@" RedisConnectionString="@REDISSERVERIP@" Initialize="true" CreateInstance="true" CreateVariable="true"/>
		<Pool Id="ANDON_COMMON" Name="ANDON_COMMON" Version="1.0.0" SQLconnectionString="@ALMDBCONNECTIONSTRING@" RedisConnectionString="@REDISSERVERIP@" Initialize="false" CreateInstance="true" CreateVariable="false">
			<!--
			<Variables>
				<Variable Name="LCID" Type="String"/>
				<Variable Name="CURRTIME" Type="DateTime"/>
				<Variable Name="RQ1" Type="String"/>
				<Variable Name="RQ2" Type="String"/>
				<Variable Name="RQ3" Type="String"/>
				<Variable Name="RQ4" Type="String"/>
				<Variable Name="RQ5" Type="String"/>
				<Variable Name="RQ6" Type="String"/>
				<Variable Name="RQ7" Type="String"/>
				<Variable Name="RQ8" Type="String"/>
				<Variable Name="RQ9" Type="String"/>
			</Variables>
			-->
		</Pool>
    </Pools>
	<UpdateProcesses>
		<UpdateProcess Name="PROC1" Type="SQL" PoolId="ANDON_COMMON">
		  <SQL InstanceKeyColumn="LCID">
        <Variables>
          <Variable Name="LCID_New" Column="LCID"/>
          <Variable Name="RQ1_New" Column="RQ1"/>
      </Variables>
			<SqlText>
			SELECT LCID,CURRTIME,RQ1,RQ2,RQ3,RQ4,RQ5,RQ6,RQ7,RQ8,RQ9 FROM dbo.AndonRequestNames('')
			</SqlText>
		  </SQL>
		</UpdateProcess>
		<UpdateProcess Name="PROC2" Type="SQL" PoolId="ANDON_ASSL">
		  <SQL InstanceKeyColumn="MACHINE_KEY">
			<SqlText>
			SELECT 
				[Key] AS MACHINE_KEY
				,[Name] AS MACHINE_NAME
				,'' AS ASE_DISCONNECTED_PHYNAME
				,[PeriodeType] AS PERIOD_TYPEENUM
				,rqCode1 AS AndonIssue1Code,rqName1 AS AndonIssue1Text,wpSN1 AS AndonIssue1WP,wpName1 AS AndonIssue1WPname
				,rqCode2 AS AndonIssue2Code,rqName2 AS AndonIssue2Text,wpSN2 AS AndonIssue2WP,wpName2 AS AndonIssue2WPname
				,rqCode3 AS AndonIssue3Code,rqName3 AS AndonIssue3Text,wpSN3 AS AndonIssue3WP,wpName3 AS AndonIssue3WPname
				,rqCode4 AS AndonIssue4Code,rqName4 AS AndonIssue4Text,wpSN4 AS AndonIssue4WP,wpName4 AS AndonIssue4WPname
				,rqCode5 AS AndonIssue5Code,rqName5 AS AndonIssue5Text,wpSN5 AS AndonIssue5WP,wpName5 AS AndonIssue5WPname
			FROM [dbo].[MonitorData_AndonRequestQueueASSL] ('','@LCID@','ASSL',1)
			</SqlText>
		  </SQL>
		</UpdateProcess>
		<UpdateProcess Name="PROC3" Type="SQL" PoolId="ANDON_ASSLCODE">
		  <SQL InstanceKeyColumn="RQCODE">
			<SqlText>
			SELECT Code AS RQCODE 
				,CodeName AS RQNAME
				,numofrequests AS RQSTATUS 
				,asLinewpName1 AS AS1NAME,asLinewpName2 AS AS2NAME,asLinewpName3 AS AS3NAME,asLinewpName4 AS AS4NAME,asLinewpName5 AS AS5NAME 
			FROM dbo.MonitorData_AndonRequestQueueCODE('','@LCID@','ASSL',1)
			</SqlText>
		  </SQL>
		</UpdateProcess>
		<UpdateProcess Name="PROC4" Type="SQL" PoolId="ANDON_SAE">
		  <SQL InstanceKeyColumn="SAEWPNAME">
			<SqlText>
			SELECT 
				WP.[WorkPlaceName] AS SAEWPNAME
				,[numofStopRequests] AS SAEWPSTATUS
				,[rqCode1] AS RQ1,[rqCode2] AS RQ2,[rqCode3] AS RQ3,[rqCode4] AS RQ4,[rqCode5] AS RQ5
			  FROM dbo.MonitorData_AndonRequestQueueWP('','@LCID@','SAEG',0) AS WP
			</SqlText>
		  </SQL>
		</UpdateProcess>
		<UpdateProcess Name="PROC5" Type="SQL" PoolId="ANDON_SAECODE">
		  <SQL InstanceKeyColumn="RQCODE">
			<SqlText>
			SELECT RC.[Code] AS RQCODE,[CodeName] AS RQNAME,[numofrequests] AS RQSTATUS
				,[wpName1] AS WP1NAME,[wpName2] AS WP2NAME,[wpName3] AS WP3NAME,[wpName4] AS WP4NAME,[wpName5] AS WP5NAME
			FROM dbo.[MonitorData_AndonRequestQueueCODE]('', '@LCID@', 'SAEG',0) AS RC
			</SqlText>
		  </SQL>
		</UpdateProcess>
	</UpdateProcesses>
	<UpdateBatches FirsRunTreshold="10" RepeatTreshold="5" SynchronizedUpdate="true">
      <UpdateBatch Name="BN1" Frequency="10">
        <UpdateProcesses>
          <UpdateProcess Name="PROC1"/>
        </UpdateProcesses>
      </UpdateBatch>
      <UpdateBatch Name="BN2" Frequency="5">
        <UpdateProcesses>
          <UpdateProcess Name="PROC2"/>
          <UpdateProcess Name="PROC3"/>
          <UpdateProcess Name="PROC4"/>
          <UpdateProcess Name="PROC5"/>
        </UpdateProcesses>
      </UpdateBatch>
	</UpdateBatches>
  </DataToRedisConfig0>
 
</XmlParserConfigurationRoot>