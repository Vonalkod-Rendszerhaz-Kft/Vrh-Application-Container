<ReportDefinitions>
<!--
A OneReport program számára meg kell adni, hogy milyen néven kérje el az XmlParser-től a general paramétereket, és a konkrét riporthoz tartozó paramétereket.
Ezek a program indítási url paraméterei lesznek.
&xmlgeneral=OneReport/General&xmlreport=OneReport/Downtime1
Ehhez a központi XmlParserben a következőt kell megadni:
    <Configuration Name=”OneReport” File=”.../OneReports.xml”/>
A OneReport.xml-ben pedig ezt:
	<Configuration Name=”General" Element=”general”/>
	<Configuration Name=”Downtime1” Element=”reports/report[@id='Downtime1'”/>
-->
	<XmlParserConfigurations>
		<Configuration Name=”General" Element=”general”/>
		<Configuration Name=”Downtime1” Element=”reports/report[@id='Downtime1'”/>
	</XmlParserConfigurations>
	<XmlParser>
		<XmlVar Name="REPORTRECORDCOUNTLIMIT">0</XmlVar>
		<XmlVar Name="SELECT_Reports_PeriodsByShift">
<!--
	INNER JOIN (SELECT P11.SHIFTSYSTEMNAME AS _SHIFTSYSTEMNAME
						,P11.SHIFTNAME AS _SHIFTNAME
						,SUM(P11.[LENGTH]) AS SUMSUMTime 
				FROM Reports_Periods AS P11 
				GROUP BY P11.SHIFTSYSTEMNAME, P11.SHIFTNAME) AS P1 
		ON P1._SHIFTSYSTEMNAME = Periods.SHIFTSYSTEMNAME AND P1._SHIFTNAME = Periods.SHIFTNAME @kSTARTFrom@ @kSTARTTo@
-->
			SELECT @_RECORDCOUNTLIMIT@
				Periods.SHIFTSYSTEMNAME,Periods.SHIFTNAME
				,PeriodeTypeNum,dbo.PeriodTypeName(Periods.PeriodeTypeNum,'@LCID@') AS PeriodeTypeName
				,Count(*) AS [Count]
				,SUM(Periods.[LENGTH]) AS SUMTime
				,(CASE Periods.PeriodeTypeNum WHEN 4 THEN -1 WHEN 3 THEN 1 ELSE 0 END) * SUM(Periods.[LENGTH]) AS SUMTimeDT
				,P1.SUMSUMTime
				,SUM([QTYproduced]) AS SUMProdCount
				,SUM([Cycles]) AS SUMCycles
			FROM Reports_Periods AS Periods
			INNER JOIN (SELECT P11.SHIFTSYSTEMNAME AS _SHIFTSYSTEMNAME
							,P11.SHIFTNAME AS _SHIFTNAME
							,SUM(P11.[LENGTH]) AS SUMSUMTime 
						FROM Reports_Periods2 AS P11 
						WHERE 1=1 @kSHIFTSYSTEMNAME@ @kSHIFTNAME@ @kSTARTFrom@ @kSTARTTo@
						GROUP BY P11.SHIFTSYSTEMNAME, P11.SHIFTNAME) AS P1 
				ON P1._SHIFTSYSTEMNAME = Periods.SHIFTSYSTEMNAME AND P1._SHIFTNAME = Periods.SHIFTNAME 
			WHERE (1=1) AND Periods.SHIFTSYSTEMNAME IS NOT NULL @kSHIFTSYSTEMNAME@ @kSHIFTNAME@ @kSTARTFrom@ @kSTARTTo@
			GROUP BY Periods.SHIFTSYSTEMNAME, Periods.SHIFTNAME, P1.SUMSUMTime, Periods.PeriodeTypeNum
		</XmlVar>
		<ConnectionString Name="defaultConnectionString">data source=.\SQLExpress;initial catalog=LearALM;user id=sa;password=Vrh@54321;MultipleActiveResultSets=True;App=EntityFramework;</ConnectionString>
	</XmlParser>
	<general>
		<defaultLCID>en-US</defaultLCID>
		<defaultoutput format="HTML" action="display" folder="~/App_Data/OneReport" file="test.pdf"/>
		<WordCodePrefix>OneReportsXml</WordCodePrefix>
		<ExternalParameterPresetXml></ExternalParameterPresetXml>		
		<Timeout Sqlquery ="180" AsyncPostBackTimeOut="440" executionTimeout="440"/>
	</general>
	<reports>
		<report id="Downtime1" reportfile="App_Data/OneReport/Downtime1 - @LCID@.rdl" connectionstring="defaultConnectionString">
			<XmlParser>
				<XmlVar Name="SHIFTSYSTEMNAME"><Value></Value></XmlVar>
				<XmlVar Name="SHIFTNAME"><Value></Value></XmlVar>
				<XmlVar Name="STARTFrom"><Value></Value></XmlVar>
				<XmlVar Name="STARTTo"><Value></Value></XmlVar>
				<XmlVar Name="UNFOLDALL"><Value>true</Value></XmlVar>
				<XmlVar Name="RECORDCOUNTLIMIT"><Value>@REPORTRECORDCOUNTLIMIT@</Value></XmlVar>
				<XmlVar Name="kSHIFTSYSTEMNAME"><Value>AND SHIFTSYSTEMNAME = '@SHIFTSYSTEMNAME@'</Value>
					<Conditions>
						<Condition Type="equal" Test="@SHIFTSYSTEMNAME@" With=""><Value></Value></Condition>
					</Conditions>
				</XmlVar>
				<XmlVar Name="kSHIFTNAME"><Value>AND SHIFTNAME = '@SHIFTNAME@'</Value>
					<Conditions>
						<Condition Type="equal" Test="@SHIFTNAME@" With=""><Value></Value></Condition>
					</Conditions>
				</XmlVar>
				<XmlVar Name="kSTARTFrom"><Value>AND ([ShiftStart] &gt;= '@STARTFrom@')</Value>
					<Conditions>
						<Condition Type="equal" Test="@STARTFrom@" With=""><Value></Value></Condition>
					</Conditions>
				</XmlVar>
				<XmlVar Name="kSTARTTo"><Value>AND ([ShiftStart] &lt;= '@STARTTo@')</Value>
					<Conditions>
						<Condition Type="equal" Test="@STARTTo@" With=""><Value></Value></Condition>
					</Conditions>
				</XmlVar>
				<XmlVar Name="_RECORDCOUNTLIMIT"><Value>TOP @RECORDCOUNTLIMIT@</Value>
					<Conditions>
						<Condition Type="equal" Test="@RECORDCOUNTLIMIT@" With="0"><Value></Value></Condition>
					</Conditions>
				</XmlVar>
				<XmlVar Name="SQLTEXT"><Value>@SELECT_Reports_PeriodsByShift@</Value></XmlVar>
			</XmlParser>
			<Displayname WordCode="Downtime1.DisplayName">Állásidő riport (műszakra összesített)</Displayname>
			<ExternalParameterPresets>
				<Preset Name="TODAY" Description="Today data up to now">
					<Parameter Name="STARTFrom"><Value>@TODAY@ 00:00:00</Value></Parameter>
					<Parameter Name="STARTTo"><Value>@TODAY@ 23:59:59</Value></Parameter>
				</Preset>
				<Preset Name="YESTERDAY" Description="Yesterday data">
					<Parameter Name="STARTFrom"><Value>@YESTERDAY@ 00:00:00</Value></Parameter>
					<Parameter Name="STARTTo"><Value>@YESTERDAY@ 23:59:59</Value></Parameter>
				</Preset>
				<Preset Name="THISWEEK" Description="This week data, not including today">
					<Parameter Name="STARTFrom"><Value>@THISWEEKMONDAY@ 00:00:00</Value></Parameter>
					<Parameter Name="STARTTo"><Value>@YESTERDAY@ 23:59:59</Value></Parameter>
				</Preset>
				<Preset Name="THISWEEK_AND_TODAY" Description="This week data, including today">
					<Parameter Name="STARTFrom"><Value>@THISWEEKMONDAY@ 00:00:00</Value></Parameter>
					<Parameter Name="STARTTo"><Value>@TODAY@ 23:59:59</Value></Parameter>
				</Preset>
				<Preset Name="LASTWEEK" Description="Last week data">
					<Parameter Name="STARTFrom"><Value>@LASTWEEKMONDAY@ 00:00:00</Value></Parameter>
					<Parameter Name="STARTTo"><Value>@LASTWEEKFRIDAY@ 23:59:59</Value></Parameter>
				</Preset>
				<Preset Name="LASTMONTH" Description="Last month data">
					<Parameter Name="STARTFrom"><Value>@LASTMONTH1STDAY@ 00:00:00</Value></Parameter>
					<Parameter Name="STARTTo"><Value>@LASTMONTHLASTDAY@ 23:59:59</Value></Parameter>
				</Preset>
			</ExternalParameterPresets>
			<ReportParameters>
				<Parameter name="SHIFTSYSTEMNAME">@SHIFTSYSTEMNAME@</Parameter>
				<Parameter name="SHIFTNAME">@SHIFTNAME@</Parameter>
				<Parameter name="STARTFrom">@STARTFrom@</Parameter>
				<Parameter name="STARTTo">@STARTTo@</Parameter>
				<Parameter name="UNFOLDALL">@UNFOLDALL@</Parameter>
				<Parameter name="SQLTEXT">@SQLTEXT@</Parameter>
			</ReportParameters>
			<datasets><dataset name="DataSet1"><datacommand type="SQL"><sql>@SQLTEXT@</sql></datacommand></dataset></datasets>	
		</report>
	</reports>
</ReportDefinitions>