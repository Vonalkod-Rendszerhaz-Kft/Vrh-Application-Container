<iSchedulerReport>
  <strings>
    <string name="reportsxml">d:\!Dev\VRH\lear-dtm\Source\WebApplication\App_Data\OneReport\OneReports.xml</string>
    <string name="messagesxml">d:\!Dev\VRH\lear-dtm\Source\WebApplication\App_Data\iScheduler\OneMessages.xml</string>
    <string name="savedreportsroot">c:\ALMBackups\ScheduledSavedReports</string>

    <string name="uadmina">UserAdministration</string>
    <string name="uadminc">UserAdministration</string>
    <string name="onerepa">OneReport</string>
    <string name="onerepc">OneReport</string>
	
	<string name="ALMserverIP">192.168.77.150</string>
	<string name="SITENAME">VRH/ALM Etalon 150</string>
  </strings>

  <connectionstrings>
    <connectionstring name="anticstr">data source=(local)\SQLEXPRESS;initial catalog=LearALM;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework;</connectionstring>
    <connectionstring name="vrhcstr">data source=.\SQLExpress;initial catalog=LearALM;user id=sa;password=Vrh@54321;MultipleActiveResultSets=True;App=EntityFramework;</connectionstring>
  </connectionstrings>

  <GroupId>GRP1</GroupId>
  <WordCodePrefix>iSchedulerReportXml</WordCodePrefix>
  <DatabaseConnectionString>anticstr</DatabaseConnectionString>

  <ObjectEditor>
    <RolenameMask>SchRepPck_@PCKNAME@</RolenameMask>
    <RolegroupListUrl>
      <area>@uadmina@</area><controller>@uadminc@</controller><action>GetRoleList</action>
      <inputparameter name="userolegroup">true</inputparameter>
      <inputparameter name="namefilter">^@roleprefix@(?'NAME'.*)$</inputparameter>
    </RolegroupListUrl>
    <UserListUrl>
      <area>@uadmina@</area><controller>@uadminc@</controller><action>GetUserList</action>
    </UserListUrl>
    <CreateRoleUrl>
      <area>@uadmina@</area><controller>@uadminc@</controller><action>CreateNewRole</action>
      <inputparameter name="rolename">@ROLENAME@</inputparameter>
    </CreateRoleUrl>
    <DeleteRoleUrl>
      <area>@uadmina@</area><controller>@uadminc@</controller><action>DeleteThisRole</action>
      <inputparameter name="rolename">@ROLENAME@</inputparameter>
    </DeleteRoleUrl>
    <AssignRoleToRolegroupsUrl>
      <area>@uadmina@</area><controller>@uadminc@</controller><action>Assignment</action>
      <inputparameter name="mode">rolestorolegroups</inputparameter>
      <inputparameter name="namelist">@ROLENAME@</inputparameter>
      <inputparameter name="targetnamelist">@ROLEGROUPLIST@</inputparameter>
    </AssignRoleToRolegroupsUrl>
    <AssignRoleToUsersUrl>
      <area>@uadmina@</area><controller>@uadminc@</controller><action>Assignment</action>
      <inputparameter name="mode">rolestousers</inputparameter>
      <inputparameter name="namelist">@ROLENAME@</inputparameter>
      <inputparameter name="targetnamelist">@USERLIST@</inputparameter>
    </AssignRoleToUsersUrl>

    <ReportListUrl>
      <area>@onerepa@</area><controller>@onerepc@</controller><action>List</action>
      <inputparameter name="xmlfile">@reportsxml@</inputparameter>
      <!--inputparameter name="LCID">*</inputparameter-->
      <inputparameter name="listmode">A</inputparameter>
    </ReportListUrl>
    <ReportParameterPresetEditorUrl>
      <area>@onerepa@</area><controller>@onerepc@</controller><action>PresetEditor</action>
      <inputparameter name="xmlfile">@reportsxml@</inputparameter>
      <inputparameter name="report">@REPORTNAME@</inputparameter>
      <inputparameter name="preset">@PARPRESET@</inputparameter>
    </ReportParameterPresetEditorUrl>
    <ReportFormatListUrl>
      <area>@onerepa@</area><controller>@onerepc@</controller><action>ListFormats</action>
    </ReportFormatListUrl>
    <TestExecuteUrl>
      <area>iSchedulerReport</area><controller>iSchedulerReport</controller><action>Execute</action>
      <inputparameter name="timestamp">@NOW@</inputparameter>
      <inputparameter name="xmlfile">@THISXMLFILE@</inputparameter>
      <inputparameter name="groupid">@GROUPID@</inputparameter>
      <inputparameter name="objectid">@OBJECTID@</inputparameter>
    </TestExecuteUrl>
  </ObjectEditor>

  <PackageExecute>
    <ReportFilePath>@savedreportsroot@\@DATESTAMP@\@ROLENAME@_@TIMESTAMP@\@REPORTNAME@-@PARPRESET@-@LCID@.@REPORTFORMAT@</ReportFilePath>
	<!-- ResponseTimeout másodpercben -->
    <ResponseTimeout>660</ResponseTimeout>
    <RunReportUrl>
      <area>OneReport</area><controller>OneReport</controller><action>File</action>
      <inputparameter name="xmlfile">@reportsxml@</inputparameter>
      <inputparameter name="report">@REPORTNAME@</inputparameter>
      <inputparameter name="preset">@PARPRESET@</inputparameter>
      <inputparameter name="lcid">@LCID@</inputparameter>
      <inputparameter name="format">@REPORTFORMAT@</inputparameter>
      <inputparameter name="file">@REPORTFILEPATH@</inputparameter>
      <inputparameter name="UNFOLDALL">true</inputparameter>
      <inputparameter name="SITENAME">@SITENAME@</inputparameter>
    </RunReportUrl>
    <SendMessageUrl>
      <area>OneMessage</area><controller>OneMessage</controller><action>SendSMTPMessage</action>
      <inputparameter name="xmlfile">@messagesxml@</inputparameter>
      <inputparameter name="msgID">ScheduledReportPackageMsg</inputparameter>
      <inputparameter name="sendto">@SENDTOEMAILLIST@</inputparameter>
      <inputparameter name="attachments">@FILEPATHLIST@</inputparameter>
      <inputparameter name="PCKNAME">@PCKNAME@-@PARPRESET@</inputparameter>
      <inputparameter name="DATESTAMP">@DATESTAMP@</inputparameter>
      <inputparameter name="TIMESTAMP">@TIMESTAMP@</inputparameter>
      <inputparameter name="ROLENAME">@ROLENAME@</inputparameter>
      <inputparameter name="REPORTFOLDER">@DATESTAMP@</inputparameter>
      <inputparameter name="REPORTSUBFOLDER">@ROLENAME@_@TIMESTAMP@</inputparameter>
      <inputparameter name="SITENAME">@SITENAME@</inputparameter>
    </SendMessageUrl>
    <UserListUrl>
	    <!-- <protocol>http</protocol><hostname>@ALMserverIP@</hostname><appname>LearALM</appname> -->
      <area>@uadmina@</area><controller>@uadminc@</controller><action>GetUserList</action>
      <inputparameter name="userolegroup">false</inputparameter>
      <inputparameter name="onlyemail">true</inputparameter>
      <inputparameter name="namelist">@ROLENAME@</inputparameter>
    </UserListUrl>
  </PackageExecute>
</iSchedulerReport>